<section class="mb-8">
    <h1 class="text-2xl md:text-3xl font-bold">Latest Blogs</h1>
    <p class="text-gray-600 mt-2">Fresh reads from technology, startup, lifestyle and more.</p>
</section>

<% if (!locals.user) { %>
    <form action="/addSubscriber" method="POST" class="mb-10 flex flex-col sm:flex-row gap-3">
        <input name="email" type="email" required placeholder="Your email"
        class="flex-1 rounded-lg border px-4 py-2" />
        <button type="submit" class="rounded-lg bg-black text-white px-5 py-2">Subscribe</button>
    </form>
<% } %>

<div class="flex gap-3 mb-6 overflow-x-auto">
    <% (categories || ['All','Technology','StartUp','LifeStyle']).forEach(cat => { 
        const isActive = (currentCategory || 'All').toLowerCase() === String(cat).toLowerCase();
    %>
        <a href="/?<%= cat === 'All' ? '' : ('category=' + encodeURIComponent(cat)) %>"
        class="px-3 py-1.5 rounded-full border transition
                <%= isActive ? 'bg-black text-white border-black' : 'bg-white hover:bg-gray-100' %>">
        <%= cat %>
        </a>
    <% }) %>
</div>

<% if (cleanBlogs.length <= 0) { %>
    <div class="p-6 rounded-xl border bg-white">No Blogs available.
        <% if (locals.user && locals.user.isAdmin) { %>
        <a class="underline ml-2" href="/user/admin">Add Blogs</a>
        <% } %>
    </div>
    <% } else { %>
    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <% cleanBlogs.forEach(blog => { %>
        <article class="rounded-xl border bg-white overflow-hidden flex flex-col" data-category="<%= (blog.category || '').toLowerCase() %>">
            <% if (blog.image) { %>
            <img src="/images/<%= blog.image %>" alt="" class="w-full h-40 object-cover">
            <% } %>
            <div class="p-4 flex-1 flex flex-col">
            <div class="text-xs uppercase tracking-wide text-gray-500"><%= blog.category %></div>
            <h3 class="mt-1 font-semibold text-lg"><%= blog.title %></h3>
            <p class="mt-2 text-sm text-gray-700 line-clamp-4"><%= blog.excerpt %>...</p>
            <div class="mt-auto pt-4">
                <a href="/blog/<%= blog._id %>" class="text-sm underline">Read more</a>
            </div>
            </div>
        </article>
        <% }) %>
    </div>
<% } %>
